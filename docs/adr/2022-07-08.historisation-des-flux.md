# Historisation des flux extraits

## Contributeurs

Caroline C., Hugues D., SÃ©bastien F., Simon B.

## Statut

*AcceptÃ©*

## Contexte

Afin de pouvoir gÃ©rer les erreurs lors des diffÃ©rentes Ã©tapes d'extraction, de transformation et de chargement des
donnÃ©es issues des diffÃ©rents flux partenaires, nous avons besoin d'historiser les flux extraits, transformÃ©s, chargÃ©s.

## DÃ©cision

Pour ce faire, nous avons dÃ©cidÃ© d'historiser ces donnÃ©es dans un bucket MinIO. De plus, nous avons dÃ©cidÃ© d'adopter la
structure d'historisation suivante :

- ğŸ“ raw 
  - ğŸ“ \<source nÂ° 1\>
    - ğŸ“ history
      - ğŸ“„ 2022-07-01T00:00:00Z.\<ext\>
      - ğŸ“„ 2022-07-02T00:00:00Z.\<ext\>
      - ğŸ“„ 2022-07-03T00:00:00Z.\<ext\>
      - ğŸ“„ ...
    - ğŸ“„ latest.\<ext\>
  - ğŸ“ \<source nÂ° 2\>
      - ğŸ“ history
        - ğŸ“„ 2022-07-01T00:00:00Z.\<ext\>
        - ğŸ“„ 2022-07-02T00:00:00Z.\<ext\>
        - ğŸ“„ 2022-07-03T00:00:00Z.\<ext\>
        - ğŸ“„ ...
      - ğŸ“„ latest.\<ext\>
  - ğŸ“ ...

- ğŸ“ json
    - ğŸ“ \<source nÂ° 1\>
        - ğŸ“ history
          - ğŸ“„ 2022-07-01T00:00:00Z.json
          - ğŸ“„ 2022-07-02T00:00:00Z.json
          - ğŸ“„ 2022-07-03T00:00:00Z.json
          - ğŸ“„ ...
        - ğŸ“„ latest.json
    - ğŸ“ \<source nÂ° 2\>
        - ğŸ“ history
          - ğŸ“„ 2022-07-01T00:00:00Z.json
          - ğŸ“„ 2022-07-02T00:00:00Z.json
          - ğŸ“„ 2022-07-03T00:00:00Z.json
          - ğŸ“„ ...
        - ğŸ“„ latest.json
    - ğŸ“ ...

- ğŸ“ result
  - ğŸ“ \<source nÂ° 1\>
      - ğŸ“ history
          - ğŸ“„ 2022-07-01T00:00:00Z_created.json
          - ğŸ“„ 2022-07-01T00:00:00Z_deleted.json
          - ğŸ“„ 2022-07-01T00:00:00Z_error.json
          - ğŸ“„ 2022-07-01T00:00:00Z_updated.json
          - ğŸ“„ ...
  - ğŸ“ \<source nÂ° 2\>
      - ğŸ“ history
          - ğŸ“„ 2022-07-01T00:00:00Z_created.json
          - ğŸ“„ 2022-07-01T00:00:00Z_deleted.json
          - ğŸ“„ 2022-07-01T00:00:00Z_error.json
          - ğŸ“„ 2022-07-01T00:00:00Z_updated.json
          - ğŸ“„ ...

N.B : La durÃ©e de conservation de l'historique sera Ã  dÃ©terminer pour chaque source et la dÃ©cision n'est pas encore arrÃªtÃ©e.

## ConsÃ©quences

Nous datons nos fichiers correctement en suivant la norme ISO 8601.

Nous Ã©crasons le ou les fichier(s) `latest` de chaque catÃ©gorie.

## Autres pistes explorÃ©es

Se contenter de l'historique (dossier `history`) sans le fichier `latest` Ã  Ã©craser Ã  chaque nouvelle Ã©criture. Cette
solution n'a pas Ã©tÃ© retenue car besoin de lister pour rÃ©cupÃ©rer le dernier fichier plutÃ´t que d'y accÃ©der directement.
