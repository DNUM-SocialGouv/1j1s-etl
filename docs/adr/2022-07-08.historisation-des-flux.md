# Historisation des flux extraits

## Contributeurs

Caroline C., Hugues D., SÃ©bastien F., Simon B.

## Statut

*AcceptÃ©*

## Contexte

Afin de pouvoir gÃ©rer les erreurs lors des diffÃ©rentes Ã©tapes d'extraction, de transformation et de chargement des
donnÃ©es issues des diffÃ©rents flux partenaires, nous avons besoin d'historiser les flux extraits, transformÃ©s, chargÃ©s.

## DÃ©cision

Pour ce faire, nous avons dÃ©cidÃ© d'historiser ces donnÃ©es dans un bucket MinIO. De plus, nous avons dÃ©cidÃ© d'adopter la
structure d'historisation suivante :

```markdown
..
â”œâ”€â”€â”€ ğŸ“ raw
â”‚    â”œâ”€â”€â”€ ğŸ“ <source-une>
â”‚    â”‚    â”œâ”€â”€â”€ ğŸ“ history
â”‚    â”‚    â”‚    â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.<ext>
â”‚    â”‚    â”‚    â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.<ext>
â”‚    â”‚    â”‚    â””â”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.<ext>
â”‚    â”‚    â””â”€â”€â”€ ğŸ“„ latest.<ext>
â”‚    â””â”€â”€â”€ ğŸ“ <source-deux>
â”‚         â”œâ”€â”€â”€ ğŸ“ history
â”‚         â”‚    â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.<ext>
â”‚         â”‚    â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.<ext>
â”‚         â”‚    â””â”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.<ext>
â”‚         â””â”€â”€â”€ ğŸ“„ latest.<ext>
â”œâ”€â”€â”€ ğŸ“ json
â”‚    â”œâ”€â”€â”€ ğŸ“ <source-une>
â”‚    â”‚    â”œâ”€â”€â”€ ğŸ“ history
â”‚    â”‚    â”‚    â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.json
â”‚    â”‚    â”‚    â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.json
â”‚    â”‚    â”‚    â””â”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.json
â”‚    â”‚    â””â”€â”€â”€ ğŸ“„ latest.json
â”‚    â””â”€â”€â”€ ğŸ“ <source-deux>
â”‚         â”œâ”€â”€â”€ ğŸ“ history
â”‚         â”‚    â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.json
â”‚         â”‚    â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.json
â”‚         â”‚    â””â”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z.json
â”‚         â””â”€â”€â”€ ğŸ“„ latest.json
â”œâ”€â”€â”€ ğŸ“ result
â”‚    â”œâ”€â”€â”€ ğŸ“ <source-une>
â”‚    â”‚    â””â”€â”€â”€ ğŸ“ history
â”‚    â”‚         â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z_created.json
â”‚    â”‚         â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z_deleted.json
â”‚    â”‚         â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z_error.json
â”‚    â”‚         â””â”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z_updated.json
â”‚    â”‚
â”‚    â””â”€â”€â”€ ğŸ“ <source-deux>
â”‚         â””â”€â”€â”€ ğŸ“ history
â”‚              â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z_created.json
â”‚              â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z_deleted.json
â”‚              â”œâ”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z_error.json
â”‚              â””â”€â”€â”€ ğŸ“„ 2022-07-01T00:00:00Z_updated.json
```

N.B : La durÃ©e de conservation de l'historique sera Ã  dÃ©terminer pour chaque source et la dÃ©cision n'est pas encore arrÃªtÃ©e.

## ConsÃ©quences

Nous datons nos fichiers correctement en suivant la norme ISO 8601.

Nous Ã©crasons le ou les fichier(s) `latest` de chaque catÃ©gorie.

## Autres pistes explorÃ©es

Se contenter de l'historique (dossier `history`) sans le fichier `latest` Ã  Ã©craser Ã  chaque nouvelle Ã©criture. Cette
solution n'a pas Ã©tÃ© retenue car besoin de lister pour rÃ©cupÃ©rer le dernier fichier plutÃ´t que d'y accÃ©der directement.

---

âš“ï¸ [Retour au sommaire](./index.md)
