"use strict";var n=["@evenements","@logements","@stages"],a=["@cli","@configuration","@test"],s=[...n,...a],i=class{static create(e){return{ImportDeclaration(t){i.checkNoCrossContext(e,t)}}}static checkNoCrossContext(e,t){let o=this.getCurrentImportModuleName(t.source.value,s);if(this.isWithinApplicationImport(o)){let r={importModuleName:o,fileModuleName:this.extractCurrentFileModuleName(e.getPhysicalFilename()),isImportFromContextModules:n.includes(o),isImportFromTechnicalModules:a.includes(o)},l=!1;switch(r.fileModuleName){case"@shared":l=this.shallAllowImportForSharedModule(r);break;case"@evenements":case"@logements":case"@stages":l=this.shallAllowImportForDomainModule(r);break;case"@configuration":l=this.shallAllowImportForConfigurationModule(r);break;default:break}l&&e.report({node:t,message:"Forbidden cross-context import"})}}static extractCurrentFileModuleName(e){let o=new RegExp(/src\/[a-zA-Z]*\//).exec(e),r="";return o!==null&&o.length>0&&(r="@".concat(o[0].split("/")[1])),r}static isWithinApplicationImport(e){return s.includes(e)}static getCurrentImportModuleName(e,t){for(let o of t)if(e.match(o))return o;return""}static shallAllowImportForSharedModule(e){return e.isImportFromContextModules||e.isImportFromTechnicalModules}static shallAllowImportForDomainModule(e){return this.isDifferentDomainModule(e)||this.isUnallowedTechnicalModule(e)}static shallAllowImportForConfigurationModule(e){return e.isImportFromTechnicalModules&&e.importModuleName!==e.fileModuleName||e.isImportFromContextModules}static isDifferentDomainModule(e){return e.isImportFromContextModules&&e.importModuleName!==e.fileModuleName}static isUnallowedTechnicalModule(e){return e.isImportFromTechnicalModules&&e.importModuleName!=="@configuration"}};module.exports={rules:{"no-cross-context-import":{create:i.create,meta:{docs:{description:"Avoid cross-context import which can lead to strong coupling across the application",recommended:"error"},type:"problem"}}},configs:{architecture:{plugins:["@1j1s"],rules:{"@1j1s/no-cross-context-import":"error"}}}};
