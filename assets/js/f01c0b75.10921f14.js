"use strict";(self.webpackChunk_1j1s_etl_docs=self.webpackChunk_1j1s_etl_docs||[]).push([[532],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var r=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,o=e.originalType,l=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),d=u(n),f=s,m=d["".concat(l,".").concat(f)]||d[f]||p[f]||o;return n?r.createElement(m,i(i({ref:t},c),{},{components:n})):r.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var o=n.length,i=new Array(o);i[0]=f;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a[d]="string"==typeof e?e:s,i[1]=a;for(var u=2;u<o;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},9381:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>u});var r=n(7462),s=(n(7294),n(3905));const o={},i="Historisation des flux extraits",a={unversionedId:"adr/2022-07-08.historisation-des-flux",id:"adr/2022-07-08.historisation-des-flux",title:"Historisation des flux extraits",description:"8 juillet 2022",source:"@site/docs/adr/2022-07-08.historisation-des-flux.md",sourceDirName:"adr",slug:"/adr/2022-07-08.historisation-des-flux",permalink:"/1j1s-etl/docs/adr/2022-07-08.historisation-des-flux",draft:!1,editUrl:"https://github.com/DNUM-SocialGouv/1j1s-etl/tree/main/docs/docs/docs/adr/2022-07-08.historisation-des-flux.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\ud83d\udcd3 ADRs",permalink:"/1j1s-etl/docs/category/-adrs"},next:{title:"Enregistrement des fichiers",permalink:"/1j1s-etl/docs/adr/2022-08-01.enregistrement-des-fichiers"}},l={},u=[{value:"Contributeurs",id:"contributeurs",level:2},{value:"Statut",id:"statut",level:2},{value:"Contexte",id:"contexte",level:2},{value:"D\xe9cision",id:"d\xe9cision",level:2},{value:"Cons\xe9quences",id:"cons\xe9quences",level:2},{value:"Autres pistes explor\xe9es",id:"autres-pistes-explor\xe9es",level:2}],c={toc:u},d="wrapper";function p(e){let{components:t,...n}=e;return(0,s.kt)(d,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"historisation-des-flux-extraits"},"Historisation des flux extraits"),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"8 juillet 2022")),(0,s.kt)("h2",{id:"contributeurs"},"Contributeurs"),(0,s.kt)("p",null,"Caroline C., Hugues D., S\xe9bastien F., Simon B."),(0,s.kt)("h2",{id:"statut"},"Statut"),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"Accept\xe9")),(0,s.kt)("h2",{id:"contexte"},"Contexte"),(0,s.kt)("p",null,"Afin de pouvoir g\xe9rer les erreurs lors des diff\xe9rentes \xe9tapes d'extraction, de transformation et de chargement des\ndonn\xe9es issues des diff\xe9rents flux partenaires, nous avons besoin d'historiser les flux extraits, transform\xe9s, charg\xe9s."),(0,s.kt)("h2",{id:"d\xe9cision"},"D\xe9cision"),(0,s.kt)("p",null,"Pour ce faire, nous avons d\xe9cid\xe9 d'historiser ces donn\xe9es dans un bucket MinIO. De plus, nous avons d\xe9cid\xe9 d'adopter la\nstructure d'historisation suivante :"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-markdown"},"..\n\u251c\u2500\u2500\u2500 \ud83d\udcc1 raw\n\u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc1 <source-une>\n\u2502    \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc1 history\n\u2502    \u2502    \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.<ext>\n\u2502    \u2502    \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.<ext>\n\u2502    \u2502    \u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.<ext>\n\u2502    \u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc4 latest.<ext>\n\u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc1 <source-deux>\n\u2502         \u251c\u2500\u2500\u2500 \ud83d\udcc1 history\n\u2502         \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.<ext>\n\u2502         \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.<ext>\n\u2502         \u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.<ext>\n\u2502         \u2514\u2500\u2500\u2500 \ud83d\udcc4 latest.<ext>\n\u251c\u2500\u2500\u2500 \ud83d\udcc1 json\n\u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc1 <source-une>\n\u2502    \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc1 history\n\u2502    \u2502    \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.json\n\u2502    \u2502    \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.json\n\u2502    \u2502    \u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.json\n\u2502    \u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc4 latest.json\n\u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc1 <source-deux>\n\u2502         \u251c\u2500\u2500\u2500 \ud83d\udcc1 history\n\u2502         \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.json\n\u2502         \u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.json\n\u2502         \u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z.json\n\u2502         \u2514\u2500\u2500\u2500 \ud83d\udcc4 latest.json\n\u251c\u2500\u2500\u2500 \ud83d\udcc1 result\n\u2502    \u251c\u2500\u2500\u2500 \ud83d\udcc1 <source-une>\n\u2502    \u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc1 history\n\u2502    \u2502         \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z_created.json\n\u2502    \u2502         \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z_deleted.json\n\u2502    \u2502         \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z_error.json\n\u2502    \u2502         \u2514\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z_updated.json\n\u2502    \u2502\n\u2502    \u2514\u2500\u2500\u2500 \ud83d\udcc1 <source-deux>\n\u2502         \u2514\u2500\u2500\u2500 \ud83d\udcc1 history\n\u2502              \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z_created.json\n\u2502              \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z_deleted.json\n\u2502              \u251c\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z_error.json\n\u2502              \u2514\u2500\u2500\u2500 \ud83d\udcc4 2022-07-01T00:00:00Z_updated.json\n")),(0,s.kt)("p",null,"N.B : La dur\xe9e de conservation de l'historique sera \xe0 d\xe9terminer pour chaque source et la d\xe9cision n'est pas encore arr\xeat\xe9e."),(0,s.kt)("h2",{id:"cons\xe9quences"},"Cons\xe9quences"),(0,s.kt)("p",null,"Nous datons nos fichiers correctement en suivant la norme ISO 8601."),(0,s.kt)("p",null,"Nous \xe9crasons le ou les fichier(s) ",(0,s.kt)("inlineCode",{parentName:"p"},"latest")," de chaque cat\xe9gorie."),(0,s.kt)("h2",{id:"autres-pistes-explor\xe9es"},"Autres pistes explor\xe9es"),(0,s.kt)("p",null,"Se contenter de l'historique (dossier ",(0,s.kt)("inlineCode",{parentName:"p"},"history"),") sans le fichier ",(0,s.kt)("inlineCode",{parentName:"p"},"latest")," \xe0 \xe9craser \xe0 chaque nouvelle \xe9criture. Cette\nsolution n'a pas \xe9t\xe9 retenue car besoin de lister pour r\xe9cup\xe9rer le dernier fichier plut\xf4t que d'y acc\xe9der directement."))}p.isMDXComponent=!0}}]);